var documenterSearchIndex = {"docs":
[{"location":"model_fitting/#Model-Fitting","page":"Model Fitting","title":"Model Fitting","text":"This guide provides comprehensive instructions for fitting variance component models using CVC.jl.","category":"section"},{"location":"model_fitting/#Genotype-Data","page":"Model Fitting","title":"Genotype Data","text":"CVC.jl requires genotype data in partitioned PLINK format. Each genetic component must be a separate set of PLINK files:\n\nanalysis_dir/\n├── G1.bed       # First genetic component\n├── G1.bim\n├── G1.fam\n├── G2.bed       # Second genetic component\n├── G2.bim\n├── G2.fam\n└── ...\n\nImportant requirements:\n\nFiles must be named G1.bed, G2.bed, ..., GK.bed (and corresponding .bim/.fam)\nAll .fam files must have identical sample ordering\nSamples in .fam must match the order of phenotype/covariate data\nSNPs should be quality-controlled before partitioning","category":"section"},{"location":"model_fitting/#Phenotype-Data","page":"Model Fitting","title":"Phenotype Data","text":"For time-to-event phenotypes:\n\nu: Vector of observed times (numeric, e.g., age at event or censoring)\nδ: Vector of censoring indicators (true = event observed, false = censored)\n\nusing DelimitedFiles\n\n# Load time-to-event data\nu = vec(readdlm(\"u.txt\"))  # e.g., [42.3, 51.7, 38.9, ...]\ndelta = Bool.(vec(readdlm(\"delta.txt\")))  # e.g., [true, false, true, ...]","category":"section"},{"location":"model_fitting/#Covariate-Matrix","page":"Model Fitting","title":"Covariate Matrix","text":"The covariate matrix should include:\n\nIntercept (column of ones) if desired\nAge, sex, principal components, etc.\n\nusing DataFrames, StatsModels\n\n# Option 1: Create manually\nN = 1000\nw = [ones(N) randn(N, 10)]  # Intercept + 10 PCs\n\n# Option 2: Use StatsModels for formula-based construction\ndf = DataFrame(age=randn(N), sex=rand([0,1], N), pc1=randn(N))\nf = @formula(~ 1 + age + sex + pc1)\nw = modelmatrix(f, df)","category":"section"},{"location":"model_fitting/#Basic-Usage","page":"Model Fitting","title":"Basic Usage","text":"","category":"section"},{"location":"model_fitting/#Initialize-and-Fit-Model","page":"Model Fitting","title":"Initialize and Fit Model","text":"using CVC\n\n# Paths\ngenotype_dir = \"/path/to/genotypes\"  # Directory with G1.bed, G2.bed, etc.\ntemp_dir = tempdir()  # Or specify custom temporary directory\n\n# Initialize CVC model (K genetic components determined by number of G*.bed files)\ncvcm = cvc(\n    u,    # N-vector of observed times\n    delta,          # N-vector of censoring indicators\n    w,                 # N × p covariate matrix\n    genotype_dir,      # Path to partitioned genotypes\n    temp_dir;          # Path for temporary files\n    J = 100,           # Number of jackknife blocks\n    B = 10             # Number of random Gaussian vectors\n)\n\n# Fit variance components\nfit_me!(cvcm)\n\n# Extract results\nprintln(\"Total heritability (observed scale):\")\nprintln(\"  h² = \", cvcm.h2[], \" ± \", cvcm.h2se[])\n\nprintln(\"\\nComponent-specific heritability:\")\nfor k in 1:length(cvcm.h2k)\n    println(\"  Component $k: \", cvcm.h2k[k], \" ± \", cvcm.h2kse[k])\nend\n\n# Variance components\nprintln(\"\\nGenetic variance components: \", cvcm.ϕg)\nprintln(\"Environmental variance: \", cvcm.ϕe[])","category":"section"},{"location":"model_fitting/#Model-Parameters","page":"Model Fitting","title":"Model Parameters","text":"","category":"section"},{"location":"model_fitting/#Constructor-Parameters","page":"Model Fitting","title":"Constructor Parameters","text":"cvc(u, delta, w, datapath, tempdir_parent; J=100, B=10)\n\nRequired arguments:\n\nu::Vector{Float64}: Observed event times\ndelta::Vector{Bool}: Censoring indicators (true = event observed, false = censored)\nw::Matrix{Float64}: N × p covariate matrix (include intercept if desired)\ndatapath::String: Directory containing partitioned PLINK files (G1.bed, G2.bed, ...)\ntempdir_parent::String: Parent directory for temporary files\n\nKeyword arguments:\n\nJ::Int: Number of jackknife blocks for standard errors (default: 100)\nB::Int: Number of random projection vectors for efficiency (default: 10)","category":"section"},{"location":"model_fitting/#Output-Interpretation","page":"Model Fitting","title":"Output Interpretation","text":"","category":"section"},{"location":"model_fitting/#Heritability-Estimates","page":"Model Fitting","title":"Heritability Estimates","text":"For time-to-event models, results are on the observed scale:\n\nh2: Total narrow-sense heritability\nh2k: Component-specific heritabilities (K genetic + 1 environmental)\nϕg: Genetic variance components (length K vector)\nϕe: Environmental variance\nAll estimates have corresponding *se fields for standard errors\n\nInterpretation: h2 represents the proportion of variance in the survival outcome explained by genetics.","category":"section"},{"location":"model_fitting/#Non-Negative-Estimates","page":"Model Fitting","title":"Non-Negative Estimates","text":"All estimates have both unconstrained and constrained versions:\n\nRegular: h2, h2k, ϕg, etc.\nConstrained: h2_nn, h2k_nn, ϕg_nn, etc.\n\nConstrained estimates impose variance components to be non-negative.","category":"section"},{"location":"model_fitting/#Complete-Example","page":"Model Fitting","title":"Complete Example","text":"Here's a complete example from data loading to results:\n\nusing CVC, DelimitedFiles\n\n# Load data\ndata_dir = \"/path/to/data\"\nu = vec(readdlm(joinpath(data_dir, \"times.txt\")))\ndelta = Bool.(vec(readdlm(joinpath(data_dir, \"delta.txt\"))))\nw = readdlm(joinpath(data_dir, \"covariates.txt\"))\n\n# Check data\nprintln(\"Sample size: \", length(u))\nprintln(\"Censoring rate: \", mean(.!delta))\nprintln(\"Number of covariates: \", size(w, 2))\n\n# Initialize model\ngenotype_dir = joinpath(data_dir, \"genotypes\")\ntemp_dir = mktempdir()\n\ncvcm = cvc(u, delta, w, genotype_dir, temp_dir; J=100, B=10)\n\n# Fit model\n@time fit_me!(cvcm)\n\n# Print results\nprintln(\"\\n=== Total Heritability ===\")\nprintln(\"h² = \", round(cvcm.h2[], digits=4), \" ± \", round(cvcm.h2se[], digits=4))\n\nprintln(\"\\n=== Component-Specific Heritability ===\")\nfor k in 1:length(cvcm.h2k)\n    h2_k = round(cvcm.h2k[k], digits=4)\n    se_k = round(cvcm.h2kse[k], digits=4)\n    println(\"  Component $k: $h2_k ± $se_k\")\nend\n\nprintln(\"\\n=== Variance Components ===\")\nfor k in 1:length(cvcm.ϕg)\n    println(\"  Genetic (comp $k): \", round(cvcm.ϕg[k], digits=4))\nend\nprintln(\"  Environmental: \", round(cvcm.ϕe[], digits=4))\n\n# NNLS estimates\nprintln(\"\\n=== NNLS (Non-Negative) Estimates ===\")\nprintln(\"h² (NNLS) = \", round(cvcm.h2_nn[], digits=4), \" ± \", round(cvcm.h2se_nn[], digits=4))","category":"section"},{"location":"model_fitting/#Accessing-Internal-Values","page":"Model Fitting","title":"Accessing Internal Values","text":"The cvc object contains many internal fields:\n\n# Sample information\ncvcm.nobs        # Number of observations\ncvcm.ncens       # Number censored\ncvcm.propcens    # Proportion censored\n\n# Dimensions\ncvcm.ngpred      # Number of SNPs across all components\ncvcm.nfpred      # Number of fixed effect predictors\ncvcm.ngcomp      # Number of genetic components (K)\n\n# Kaplan-Meier estimator\ncvcm.km          # KaplanMeier object","category":"section"},{"location":"#CVC.jl-Introduction","page":"Introduction","title":"CVC.jl Introduction","text":"CVC.jl (Censored Variance Component) is a Julia package for estimating heritability and variance components from genetic data with censored time-to-event phenotypes.","category":"section"},{"location":"#Overview","page":"Introduction","title":"Overview","text":"Heritability estimation is a fundamental problem in statistical genetics, but traditional methods assume continuous, normally distributed phenotypes. Many important clinical outcomes are time-to-event (e.g., age at diagnosis, survival time). CVC.jl addresses this challenge by:\n\nHandling censored data: Uses synthetic variable methods (Leurgans and Koul-Susarla-Van Ryzin) to transform right-censored time-to-event data into pseudo-continuous responses suitable for variance component analysis.\nPartitioned heritability: Estimates variance components across K genetic components (e.g., chromosomes and gene sets) to understand the genetic architecture of complex traits.\nScalability: Handles biobank-scale data through memory-mapping, randomized trace estimator, and column-wise block jackknife for standard error estimation.","category":"section"},{"location":"#What-CVC-Does","page":"Introduction","title":"What CVC Does","text":"For survival/time-to-event phenotypes with right-censoring:\n\nh^2 = fracsum_k=1^K sigma_k^2sum_k=1^K sigma_k^2 + sigma_e^2\n\nwhere sigma_k^2 represents the variance component of the kth genetic partition and sigma_e^2 is the environmental variance.\n\nSynthetic Variable Approach: CVC transforms censored data (T_i delta_i) where T_i is observed time and delta_i indicates censoring status into synthetic continuous variables using Kaplan-Meier estimator of the censoring distribution.","category":"section"},{"location":"#Key-Features","page":"Introduction","title":"Key Features","text":"Time-to-event phenotypes with right-censoring support\nPartitioned analysis: Estimate K genetic components + 1 environmental component\nStandard errors: Block jackknife with customizable number of blocks (J=100 default)\nComputational efficiency: Randomized trace estimator to reduce computation (B = 10 random Gaussian vectors default)\nFlexible constraints: Both unconstrained and constrained non-negative estimates\nMemory efficiency: Memory-mapped PLINK and working arrays for analyzing large-scale genetic data","category":"section"},{"location":"#Installation","page":"Introduction","title":"Installation","text":"This package requires Julia v1.5 or later. You can obtain Julia from julialang.org/downloads.\n\nThe package is currently under development. To install, start Julia and use the ] key to switch to the package manager REPL:\n\n(@v1.9) pkg> add https://github.com/dohyunkim116/CVC.jl","category":"section"},{"location":"#Getting-Started","page":"Introduction","title":"Getting Started","text":"using CVC\n\n# Initialize model\ncvcm = cvc(observed_times, censoring_indicators, covariates, \n           genotype_path, temp_dir; J=100, B=10)\n\n# Fit variance components\nfit_me!(cvcm)\n\n# Extract results\nprintln(\"Heritability: \", cvcm.h2[], \" ± \", cvcm.h2se[])\nprintln(\"Component-specific: \", cvcm.h2k)","category":"section"}]
}
